var o=(e=>(e.STRUCTURE="antetype.structure",e.MIDDLE="antetype.structure.middle",e.BAR_BOTTOM="antetype.structure.bar.bottom",e.CENTER="antetype.structure.center",e.COLUMN_LEFT="antetype.structure.column.left",e.COLUMN_RIGHT="antetype.structure.column.right",e.BAR_TOP="antetype.structure.bar.top",e.MODULES="antetype.modules",e.ACTIONS="antetype.structure.column.left.actions",e))(o||{});var c=(e=>(e.STRUCTURE="antetype.structure",e.MIDDLE="antetype.structure.middle",e.BAR_BOTTOM="antetype.structure.bar.bottom",e.CENTER="antetype.structure.center",e.COLUMN_LEFT="antetype.structure.column.left",e.COLUMN_RIGHT="antetype.structure.column.right",e.BAR_TOP="antetype.structure.bar.top",e.MODULES="antetype.modules",e.ACTIONS="antetype.structure.column.left.actions",e))(c||{}),a=(e=>(e.INIT="antetype.init",e.DRAW="antetype.draw",e.CALC="antetype.calc",e))(a||{}),m=class{#t;#r=null;#e=null;static inject={minstrel:"boardmeister/minstrel",herald:"boardmeister/herald"};inject(e){this.#t=e}async#s(e,t){if(!this.#e){let r=this.#t.minstrel.getResourceUrl(this,"core.js");this.#r=(await import(r)).default,this.#e=this.#r({canvas:t,modules:e,injected:this.#t})}return this.#e}async register(e){let{modules:t,canvas:r}=e.detail;t.core=await this.#s(t,r)}async init(e){if(!this.#e)throw new Error("Instance not loaded, trigger registration event first");let{base:t,settings:r}=e.detail;for(let s in r)this.#e.setting.set(s,r[s]);let i=this.#e.meta.document;i.base=t;let n=[];return(this.#e.setting.get("fonts")??[]).forEach(s=>{n.push(this.#e.font.load(s))}),await Promise.all(n),i.layout=await this.#e.view.recalculate(i,i.base),await this.#e.view.redraw(i.layout),i}async cloneDefinitions(e){if(!this.#e)throw new Error("Instance not loaded, trigger registration event first");e.detail.element!==null&&(e.detail.element=await this.#e.clone.definitions(e.detail.element))}static subscriptions={[c.MODULES]:"register","antetype.init":"init","antetype.calc":[{method:"cloneDefinitions",priority:-255}]}};var u=(s=>(s.POSITION="antetype.cursor.position",s.DOWN="antetype.cursor.on.down",s.UP="antetype.cursor.on.up",s.MOVE="antetype.cursor.on.move",s.SLIP="antetype.cursor.on.slip",s))(u||{}),l=class{#t;#r=null;#e=null;static inject={minstrel:"boardmeister/minstrel",herald:"boardmeister/herald"};inject(t){this.#t=t}async register(t){let{modules:r,canvas:i}=t.detail;if(!this.#r){let n=this.#t.minstrel.getResourceUrl(this,"module.js");this.#r=(await import(n)).default}this.#e=r.cursor=this.#r({canvas:i,modules:r,injected:this.#t})}draw(t){if(!this.#e)return;let{element:r}=t.detail,n={selection:this.#e.drawSelection}[r.type];typeof n=="function"&&n(r)}static subscriptions={[o.MODULES]:"register",[a.DRAW]:"draw"}},d=l,b=d;export{l as AntetypeCursor,u as Event,b as default};
